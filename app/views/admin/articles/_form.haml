:css
	#article input[type="text"],
	#article textarea{ width:95% }
	#errors{ display:block; width:95%; border:1px solid red; }
	ul#article li{ margin-top:10px; }
	#article li.authors li { margin:0px; padding:0px }
	ul.sources{ margin-left:30px; border-bottom:1px solid #CCC; padding-bottom:5px; }
	
:javascript
	$(function(){
	
		$("a.clone-source").live("click",function(e){
			e.preventDefault();
			new_item = $(this).parent().parent().clone();
			new_item.appendTo($("div.sources-list"));
			
			$("ul.sources").each(function(i,val){
				$("li.title input",val).attr("name",
					"article[sources_attributes]["+i+"][title]"
				);
				$("li.url input",val).attr("name",
					"article[sources_attributes]["+i+"][url]"
				);
			});
		});
	
	});
	
=form_for([:admin,@article]) do |f|

	-if f.object.errors.any?
		#form_errors
			%ul
				- f.object.errors.full_messages.each do |e|
					%li=e

	%ul#article
		%li
			%strong=f.label :title, Article.human_attribute_name(:title)
			%br/
			=f.text_field :title
		%li
			%strong=f.label :image, Article.human_attribute_name(:image)
			%br/
			=f.text_field :image
		%li
			%strong=f.label :slug, Article.human_attribute_name(:slug)
			%br/
			=f.text_field :slug
			
		%li
			%strong=f.label :category, Article.human_attribute_name(:category)
			=f.collection_select :category_id, Category.all, :id, :to_s
		
		%li
			%strong=f.label :tags_list, Article.human_attribute_name(:tags)
			=f.text_field :tag_list
			
		%li
			%strong=f.label :intro, Article.human_attribute_name(:intro)
			%br/
			=f.text_area :intro, :rows => 5
			%div{:style=>"text-align:right; width:95%"}
				=link_to "* Urejevalnik uporablja RedCloth markup", "http://redcloth.org/"
		%li
			%strong=f.label :body, Article.human_attribute_name(:body)
			%br/
			=f.text_area :body
			%br/
			%div{:style=>"text-align:right; width:95%"}
				=link_to "* Urejevalnik uporablja RedCloth markup", "http://redcloth.org/"
				
		%li
			%strong Sources
			
			.sources-list
				= f.fields_for :sources do |s|
					%ul.sources
						%li.title
							%strong=s.label :title
							%br/
							=s.text_field :title
						%li.url
							%strong=s.label :url
							%br/
							=s.text_field :url
						
						%li
							- unless @article.new_record?
								%strong=t(:delete)
								= s.check_box :_destroy
								|
							
							%a.clone-source(href="#clone")
								=t(:clone)
							
		%li
			%strong=f.label :published, Article.human_attribute_name(:published)
			=f.check_box :published
		%li.authors
			%br/
			%strong= Article.human_attribute_name(:authors)
			%ul
				- User.authors.each do |author|
					%li
						%label
							= author
							= check_box_tag "article[author_ids][]", author.id, @article.authors.include?(author)

		%li
			%br/
			=link_to t("back"), admin_articles_path()
			
			- unless f.object.new_record?
				|
				=link_to t("destroy"), admin_article_path(f.object), :method => :delete
				|
				
			=f.submit t("save")
			